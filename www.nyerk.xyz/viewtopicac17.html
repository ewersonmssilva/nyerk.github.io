<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.nyerk.xyz/viewtopic.php?p=1343 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 12 May 2018 09:46:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Copy Paste. - Nyerk</title>


	<link rel="canonical" href="viewtopica90f.html?t=246">

<!--
	phpBB style name: we_universal
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:      nextgen ( http://xeronix.org/ )
-->


<link href="styles/prosilver/theme/stylesheet5d79.css?assets_version=25" rel="stylesheet">
<link href="assets/css/font-awesome.min5d79.css?assets_version=25" rel="stylesheet">
<link href="styles/we_universal/theme/stylesheet5d79.css?assets_version=25" rel="stylesheet">
<link href="styles/prosilver/theme/responsive5d79.css?assets_version=25" rel="stylesheet">
<link href="styles/we_universal/theme/responsive5d79.css?assets_version=25" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/prosilver/theme/tweaks.css?assets_version=25" rel="stylesheet">
<![endif]-->


<link href="ext/gfksx/ThanksForPosts/styles/prosilver/theme/thanks5d79.css?assets_version=25" rel="stylesheet" type="text/css" media="screen" />



<!--[if lt IE 9]>
	<script type="text/javascript" src="./styles/we_universal/template/html5shiv.min.js"></script>
<![endif]-->

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr  logged-out">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div class="inventea-headerbar">
		<nav class="inventea-wrapper inventea-userbar">
			<div class="dropdown-container hidden inventea-mobile-dropdown-menu">
    <a href="#" class="dropdown-trigger inventea-toggle"><i class="icon fa fa-bars"></i></a>
    <div class="dropdown hidden">
        <div class="pointer"><div class="pointer-inner"></div></div>
        <ul class="dropdown-contents" role="menubar">
		
														
							<li>
								<a href="index-2.html" role="menuitem">
									<i class="icon fa fa-fw fa-home" aria-hidden="true"></i><span>Board index</span>
								</a>
							</li>		
							
							<li data-skip-responsive="true">
								<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
									<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
								</a>
							</li>
							
													<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
							
														
														
								
						
							<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
	
						
							
            																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
						            
				                    </ul>
    </div>
</div>

			
			<ul class="linklist bulletin inventea-user-menu" role="menubar">
										<li class="small-icon rightside" data-skip-responsive="true"><a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem"><i class="icon fa-fw fa-sign-in" aria-hidden="true"></i>Login</a></li>
											<li class="small-icon rightside" data-skip-responsive="true"><a href="ucp8319.html?mode=register" role="menuitem"><i class="icon fa-fw fa-user-plus" aria-hidden="true"></i>Register</a></li>
										
										
							</ul>
		</nav>
	</div>

	<header class="inventea-header">
			
		<div class="inventea-dashboard" role="banner">
						<nav role="navigation">
	<div class="inventea-posts-menu">
		<ul class="inventea-menu" role="menubar">
			
																			<li><a href="search33a7.html?search_id=unanswered" role="menuitem">Unanswered topics</a></li>
				<li><a href="search526f.html?search_id=active_topics" role="menuitem">Active topics</a></li>
			
					</ul>
	</div>

	<div class="inventea-forum-menu">
		<ul class="inventea-menu" role="menubar">
			
			<li><a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">FAQ</a></li>
			<li><a href="search.html" role="menuitem">Search</a></li>
											<li><a href="memberlist4bfd.html?mode=team" role="menuitem">The team</a></li>			
						
					</ul>
	</div>
</nav>

			<div class="inventea-sitename">
				<h1><a href="index-2.html" title="Board index">Nyerk</a></h1>
				<span>An Forum about Aion</span>
			</div>
		</div>
			</header>

	<div class="inventea-wrapper inventea-content" role="main">
		
		<ul id="nav-breadcrumbs" class="linklist navlinks" role="menubar">
			
									<li class="small-icon breadcrumbs">
												<span class="crumb" itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index-2.html" accesskey="h" data-navbar-reference="index" itemprop="url"><span itemprop="title">Board index</span></a></span>
														<span class="crumb" itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">AionScript</span></a></span>
																			<span class="crumb" itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="6"><a href="viewforumcf19.html?f=6" itemprop="url"><span itemprop="title">General Discussion</span></a></span>
																</li>
					</ul>

		
		
<h2 class="topic-title"><a href="viewtopicedb6.html?f=6&amp;t=246">Copy Paste.</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->



<div class="action-bar bar-top">
	
			<a href="posting1b11-2.html?mode=reply&amp;f=6&amp;t=246" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic79d6.html?f=6&amp;t=246&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.nyerk.xyz/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topicâ€¦" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="246" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			9 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




			<div id="p1336" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile1336">
			<dt class="no-profile-rank has-avatar">
				
				<div class="avatar-container">
																<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="avatar"><img class="avatar" src="download/filee04a.png?avatar=571_1503261469.png" width="150" height="150" alt="User avatar" /></a>														</div>
								<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search84ef.html?author_id=571&amp;sr=posts">65</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Aug 20, 2017 3:06 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="571"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/true.html">24 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="571"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/false.html">1 time</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1336">

						<h3 class="first"><a href="#p1336">Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="posting54c2.html?mode=quote&amp;f=6&amp;p=1336" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic5c41.html?p=1336#p1336" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a></strong> &raquo; </span>Sat Aug 26, 2017 2:57 pm
			</p>
			
			
			
			<div class="content">Can anybody paste 	official crafting code without this :<br>
	--if Player:GetTargetID() == 0 then<br>
	--	PlayerInput:Escape()<br>
	--end<br>
<br>
I deselected it but it still stopping after 1times</div>

			
									
						<div id='list_thanks1336'>
</div>
<div id='div_post_reput1336'>
</div>
			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1338" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile1338">
			<dt class="no-profile-rank no-avatar">
				
				<div class="avatar-container">
																			</div>
								<a href="memberliste9a7.html?mode=viewprofile&amp;u=60" class="username">unkn0wnus3r</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1175.html?author_id=60&amp;sr=posts">75</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Jan 18, 2017 12:27 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="60"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/60/true.html">10 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="60"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/60/false.html">13 times</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1338">

						<h3 ><a href="#p1338">Re: Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="posting1a8b.html?mode=quote&amp;f=6&amp;p=1338" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicc547.html?p=1338#p1338" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste9a7.html?mode=viewprofile&amp;u=60" class="username">unkn0wnus3r</a></strong> &raquo; </span>Sun Aug 27, 2017 1:04 am
			</p>
			
			
			
			<div class="content"><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>--[[

	--------------------------------------------------
	Copyright (C) 2011 TheyRot

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
	--------------------------------------------------
	
	--------------------------------------------------
	Material List : https://www.nyerk.xyz/viewtopic.php?f=7&amp;t=121
	--------------------------------------------------

--]]

--- OnLoad is called when the script initially loads.
--
-- @return	void
function OnLoad()
	Write( "Make sure you have sufficient items in your inventory" )
	Write( "Your starting position should be in the crafting area" )
	Write( "Close all work orders in progress before starting" )
	Write( "" )
	Write( "Material List: https://www.nyerk.xyz/viewtopic.php?f=7&amp;t=121")
	
	-- Script settings, never go below 500 milliseconds. Increase for higher latency.
	click_wait_time = 1000			-- Wait time in milliseconds after each click.
	move_via_auto_approach = true	-- Set to true when you want to use auto approach for move to NPC.
	
	-- Script settings, do not touch
	learning = 1 					-- Initially the script needs to learn the htmls
	first_screen = 0				-- First screen html index
	timer = 0						-- Restrict clicking using this timer.
	crafting_step = 0				-- Crafting step
	enable_craft = 0				-- The script determines if the starting position is correct to start crafting
	abandon_workorder = 0;			-- Used to select work order in the journal to close failed work orders
	learned = 0;					-- Check if the screens have been learned
	enough_materials = 0			-- Material check
	
	-- Check which NPC with workorders is closest to you and do the work orders.
    NPC_name = CheckWorkorder()
	
	-- Non-configurable variables, do not touch any of these.
    start_location = Player:GetPosition();	-- Starting position to run to. This HAS to be in the crafting area!
	
end

--- OnRun is called each frame.
--
-- @return	void

function OnRun()
	-- Delay to skip YAY-crafted-an-item-animation
	if DialogList:GetDialog( "making_dialog" ):IsVisible() then
		timer = Time() + 4000 
		return
	end

	if Time() &gt; timer and not Player:IsMoving() then

		if InventoryList:GetSlotCurrent() == InventoryList:GetSlotMaximum() then
			Write("Your inventory is full, aborting script")
			Close()
		end
		
		-- Initial set-up of closing all screens
		if crafting_step == 0 then 
		
			if DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- close dialog screen
				stop_chat();
			elseif DialogList:GetDialog( "tool_making_dialog" ):IsVisible() then -- Crafting screen
				DialogList:GetDialog( "tool_making_dialog" ):SetVisible(false)
			else
				if learned == 0 then
					crafting_step = 1
				else
					crafting_step = 2
				end
			end
			
		-- Learn first screen dialog code
		elseif crafting_step == 1 then
		
			if not DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- no dialog, talk to npc
				start_chat()
			elseif first_screen == 0 then -- Learn the html code of the first screen
				first_screen = DialogList:GetDialog( "dlg_dialog/html_view" ):GetHTML()
				DialogList:GetDialog( "dlg_dialog/html_view/2" ):Click()
			elseif DialogList:GetDialog( "dlg_dialog/accept" ):IsVisible() then -- Accepting quest
				DialogList:GetDialog( "dlg_dialog/accept" ):Click()
				learned = 1
				crafting_step = 4
			elseif DialogList:GetDialog( "dlg_dialog/ok" ):IsVisible() then -- Already have the crafting quest accepted
				stop_chat();
				crafting_step = 3 -- stop the current work order
			else
				DialogList:GetDialog( "dlg_dialog/html_view/1" ):Click()
			end
			
		-- Aquiring the work order
		elseif crafting_step == 2 then 
		
			if not DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- no dialog, talk to npc (trying to make it idiot proof)
				start_chat()
			elseif DialogList:GetDialog( "dlg_dialog/html_view" ):GetHTML() == first_screen then -- First screen is open
				DialogList:GetDialog( "dlg_dialog/html_view/2" ):Click()
			elseif DialogList:GetDialog( "dlg_dialog/accept" ):IsVisible() then -- Accepting quest
				DialogList:GetDialog( "dlg_dialog/accept" ):Click()
				crafting_step = 4 -- go to starting position and close dialogs
			elseif DialogList:GetDialog( "dlg_dialog/ok" ):IsVisible() then -- Already have the crafting quest accepted
				stop_chat();
				crafting_step = 3 -- stop the current work order
			else -- second screen is open
				DialogList:GetDialog( "dlg_dialog/html_view/1" ):Click()
			end
			
		-- Stop the current work order (failed to craft everything)
		elseif crafting_step == 3 then
			
			if not DialogList:GetDialog( "quest_dialog" ):IsVisible() then -- Journal is not opened
				DialogList:GetDialog( "quest_dialog" ):SetVisible(true)
			else -- Journal is open
				if not DialogList:GetDialog( "quest_dialog/1/working_page/task_tab" ):IsVisible() then -- work order is not yet selected
					DialogList:GetDialog( "quest_dialog/quest_tabframe/quest_tab_task" ):Click()
				elseif not DialogList:GetDialog( "quest_dialog/giveup" ):IsEnabled() then -- work order tab is selected, work order is not selected
					local hDialog = DialogList:GetDialog( "quest_dialog/1/working_page/task_tab/working_list/0/1" )
					PlayerInput:Click( hDialog:GetPosition().X + ( 0.5 * hDialog:GetSize().X ), hDialog:GetPosition().Y + 5 )
				else
					local DidFindMatch = false;
					-- Iterate through the dialog to find a non-named confirmation dialog.
					for i = 0, DialogList:GetDialogSize() - 1 do
						-- Retrieve the dialog.
						local CurrentDialog = DialogList:GetDialogIndex( i, false );
						-- Check if the dialog matches expectations.
						if CurrentDialog ~= nil and CurrentDialog:GetName() == "" then
							-- Check if the dialog is visible and the OK button can be clicked.
							if CurrentDialog:IsVisible() and CurrentDialog:GetDialog( "ok" ) ~= nil then
								CurrentDialog:GetDialog( "ok" ):Click()
								DialogList:GetDialog( "quest_dialog" ):SetVisible(false)
								crafting_step = 2
								DidFindMatch = true;
							end
						-- Otherwise break from the iteration.
						else
							break;
						end
					end
					-- If a match was not found, the quest has to be abandoned.
					if not DidFindMatch then
						DialogList:GetDialog( "quest_dialog/giveup" ):Click()
					end
				end
			end

		-- Close dialogs and move to starting position
		elseif crafting_step == 4 then

			if DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- close dialog screen
				stop_chat();
			elseif DialogList:GetDialog( "tool_making_dialog" ):IsVisible() then -- Crafting screen
				DialogList:GetDialog( "tool_making_dialog" ):SetVisible(false)
			else 
				Player:SetMove( start_location )
				crafting_step = 5
			end
			
		-- Crafting
		elseif crafting_step == 5 then
			if DialogList:GetDialog( "tool_making_dialog" ):IsVisible() then -- craft screen is open
			
				if enable_craft == 0 then -- initially click the correct work order
					local hDialog = DialogList:GetDialog( "tool_making_dialog/making_scroll/making_ext0/making_list0" )
					PlayerInput:Click( hDialog:GetPosition().X + ( 0.5 * hDialog:GetSize().X ), hDialog:GetPosition().Y + 5 )
					enable_craft = 1
				else
				
					-- Check if you have enough materials on you
					if not DialogList:GetDialog( "tool_making_dialog/button_start_all" ):IsEnabled() and enough_materials == 0 then
						Write("Not enough materials/Incorrect starting position")
						Close()
						return
					else
						enough_materials = 1
					end
				
					if DialogList:GetDialog( "tool_making_dialog/button_start_all" ):IsEnabled() then
						DialogList:GetDialog( "tool_making_dialog/button_start_all" ):Click()
					else
						if enable_craft then -- reset script for next crafting iteration
							enable_craft = 0
							enough_materials = 0
							crafting_step = 6
							timer = Time() + 1000
						else
							Write( "Your starting location is not in a crafting area/nor you do not have the required items" )
							Close()
						end
					end
				end
			-- Craft screen has to be opened
			else
				if NPC_name == "Lainita" or NPC_name == "Hestia" then -- Cooking
					PlayerInput:Console("/skill Cooking")
				elseif NPC_name == "Honir" or NPC_name == "Diana" then -- Alchemy
					PlayerInput:Console("/skill Alchemy")
				elseif NPC_name == "Zyakia" or NPC_name == "Daphnis" then -- Tailoring
					PlayerInput:Console("/skill Tailoring")
				elseif NPC_name == "Kinterun" or NPC_name == "Vulcanus" then -- Armorsmithing
					PlayerInput:Console("/skill Armorsmithing")
				elseif NPC_name == "Logi" or NPC_name == "Anteros" then -- Weaponsmithing
					PlayerInput:Console("/skill Weaponsmithing")
				elseif NPC_name == "Lanse" or NPC_name == "Utsida" then -- Handicrafting
					PlayerInput:Console("/skill Handicrafting")
				end
			end
			
		-- Close crafting dialog
		elseif crafting_step == 6 then 
		
			if DialogList:GetDialog( "tool_making_dialog" ):IsVisible() then -- craft screen is open
				DialogList:GetDialog( "tool_making_dialog" ):SetVisible(false)
			else
				crafting_step = 7
			end
			
		-- hand in work order
		elseif crafting_step == 7 then
		
			if not DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- no dialog, talk to npc
				start_chat()
			elseif DialogList:GetDialog( "dlg_dialog/html_view" ):GetHTML() == first_screen then
				DialogList:GetDialog( "dlg_dialog/html_view/2" ):Click()
			elseif DialogList:GetDialog( "dlg_dialog/ok" ):IsVisible() then -- Hand in the work order
				DialogList:GetDialog( "dlg_dialog/ok" ):Click()
				crafting_step = 2 -- Blastradius: No need for Step #0, we can go to Step #2 and avoid dialog bugs.
			else -- second screen is open
				DialogList:GetDialog( "dlg_dialog/html_view/1" ):Click()
			end
			
		end
		
		timer = Time() + click_wait_time

	end
	
end

function start_chat()
	if Player:GetTargetID() == 0 then
		PlayerInput:Escape()
	end

	local Entity = EntityList:GetEntity( NPC_name )
	if Player:GetTargetID() ~= Entity:GetID()  then -- Move to the target NPC
		Player:SetTarget( Entity )
		if not move_via_auto_approach then
			Player:SetMove( Entity:GetPosition())
		end
	else -- start dialog
		PlayerInput:Console( '/attack' )
	end

end	

function stop_chat()

	-- Get the information for the dialog.
	local DlgDialog = DialogList:GetDialog( "dlg_dialog" );
	local DlgPosition = DlgDialog:GetPosition();
	local DlgSize = DlgDialog:GetSize();
	
	-- Get the information for the cancel button. Avoid names, there are two similar named buttons.
	local CnlDialog = DialogList:GetDialog( "dlg_dialog/8" );
	local CnlSize = CnlDialog:GetSize();
	
	-- Calculate the real position on the X- and Y-axis.
	local Real_X = DlgPosition.X + DlgSize.X - ( DlgSize.X / 100 * 4 );
	local Real_Y = DlgPosition.Y + CnlSize.Y - ( CnlSize.Y / 100 * 4 );

	-- Click the button and continue.
	PlayerInput:Click( Real_X, Real_Y );
	
end

function CheckWorkorder()

	local NPCs = {"Lainita", "Honir", "Zyakia", "Kinterun", "Logi", "Lanse", "Diana", "Vulcanus", "Hestia", "Utsida", "Daphnis", "Anteros"}
	local Distance1 = 100
	local Distance2 = 100
	local NPC_name = ""
	
	for ID, Entity in DictionaryIterator( EntityList:GetList()) do
		for i = 1, #NPCs, 1 do
			if Entity:GetName() == NPCs[i] then
				Distance2 = Entity:GetPosition():DistanceToPosition( Player:GetPosition());
				if Distance2 &lt;= Distance1 then
				Write("Setting " .. NPCs[i] );
				Write(Distance2);
					NPC_name = NPCs[i]
					Distance1 = Distance2
				end
			end
		end
	end
	
	-- Visual verification
	if Distance1 == 100 then
		Write("No NPC nearby to do crafting")
		Close()
	else
		Write("NPC found with name " .. NPC_name)
		Write("with distance of " .. Distance1 .. " units")
		
		return NPC_name
	end

end
</code></pre></div></div>

			
									
						<div id='list_thanks1338'>
</div>
<div id='div_post_reput1338'>
</div>
			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1340" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile1340">
			<dt class="no-profile-rank has-avatar">
				
				<div class="avatar-container">
																<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="avatar"><img class="avatar" src="download/filee04a.png?avatar=571_1503261469.png" width="150" height="150" alt="User avatar" /></a>														</div>
								<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search84ef.html?author_id=571&amp;sr=posts">65</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Aug 20, 2017 3:06 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="571"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/true.html">24 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="571"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/false.html">1 time</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1340">

						<h3 ><a href="#p1340">Re: Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="posting44b0.html?mode=quote&amp;f=6&amp;p=1340" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopice5f6.html?p=1340#p1340" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a></strong> &raquo; </span>Sun Aug 27, 2017 2:47 pm
			</p>
			
			
			
			<div class="content">it's working THANK YOU</div>

			
									
						<div id='list_thanks1340'>
</div>
<div id='div_post_reput1340'>
</div>
			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1342" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile1342">
			<dt class="no-profile-rank has-avatar">
				
				<div class="avatar-container">
																<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="avatar"><img class="avatar" src="download/filee04a.png?avatar=571_1503261469.png" width="150" height="150" alt="User avatar" /></a>														</div>
								<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search84ef.html?author_id=571&amp;sr=posts">65</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Aug 20, 2017 3:06 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="571"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/true.html">24 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="571"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/false.html">1 time</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1342">

						<h3 ><a href="#p1342">Re: Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="posting24a1.html?mode=quote&amp;f=6&amp;p=1342" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic12c3.html?p=1342#p1342" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a></strong> &raquo; </span>Sun Aug 27, 2017 2:55 pm
			</p>
			
			
			
			<div class="content">But its opening system menu why ?</div>

			
									
						<div id='list_thanks1342'>
</div>
<div id='div_post_reput1342'>
</div>
			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1343" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile1343">
			<dt class="no-profile-rank no-avatar">
				
				<div class="avatar-container">
																			</div>
								<a href="memberliste9a7.html?mode=viewprofile&amp;u=60" class="username">unkn0wnus3r</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1175.html?author_id=60&amp;sr=posts">75</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Jan 18, 2017 12:27 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="60"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/60/true.html">10 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="60"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/60/false.html">13 times</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1343">

						<h3 ><a href="#p1343">Re: Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="postinga6da.html?mode=quote&amp;f=6&amp;p=1343" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicac17.html?p=1343#p1343" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste9a7.html?mode=viewprofile&amp;u=60" class="username">unkn0wnus3r</a></strong> &raquo; </span>Sun Aug 27, 2017 11:07 pm
			</p>
			
			
			
			<div class="content">Because its pressing esc so that the target gets deselected.<br>
I can fix that if its too anoying^^</div>

			
									
						<div id='list_thanks1343'>
</div>
<div id='div_post_reput1343'>
</div>
			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1345" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile1345">
			<dt class="no-profile-rank has-avatar">
				
				<div class="avatar-container">
																<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="avatar"><img class="avatar" src="download/filee04a.png?avatar=571_1503261469.png" width="150" height="150" alt="User avatar" /></a>														</div>
								<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search84ef.html?author_id=571&amp;sr=posts">65</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Aug 20, 2017 3:06 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="571"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/true.html">24 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="571"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/false.html">1 time</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1345">

						<h3 ><a href="#p1345">Re: Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="posting945c.html?mode=quote&amp;f=6&amp;p=1345" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic9a45.html?p=1345#p1345" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a></strong> &raquo; </span>Mon Aug 28, 2017 12:32 am
			</p>
			
			
			
			<div class="content">its stopping cuz of that esc i think u should change it with f1 (selecting self)</div>

			
									
						<div id='list_thanks1345'>
</div>
<div id='div_post_reput1345'>
</div>
			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1346" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile1346">
			<dt class="no-profile-rank no-avatar">
				
				<div class="avatar-container">
																			</div>
								<a href="memberliste9a7.html?mode=viewprofile&amp;u=60" class="username">unkn0wnus3r</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1175.html?author_id=60&amp;sr=posts">75</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Jan 18, 2017 12:27 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="60"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/60/true.html">10 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="60"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/60/false.html">13 times</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1346">

						<h3 ><a href="#p1346">Re: Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="posting7445.html?mode=quote&amp;f=6&amp;p=1346" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopice75f.html?p=1346#p1346" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste9a7.html?mode=viewprofile&amp;u=60" class="username">unkn0wnus3r</a></strong> &raquo; </span>Mon Aug 28, 2017 11:54 am
			</p>
			
			
			
			<div class="content">I made it /attack instead of pressing escape, didnt try it tho
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>--[[

	--------------------------------------------------
	Copyright (C) 2011 TheyRot

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
	--------------------------------------------------
	
	--------------------------------------------------
	Material List : https://www.nyerk.xyz/viewtopic.php?f=7&amp;t=121
	--------------------------------------------------

--]]

--- OnLoad is called when the script initially loads.
--
-- @return	void
function OnLoad()
	Write( "Make sure you have sufficient items in your inventory" )
	Write( "Your starting position should be in the crafting area" )
	Write( "Close all work orders in progress before starting" )
	Write( "" )
	Write( "Material List: https://www.nyerk.xyz/viewtopic.php?f=7&amp;t=121")
	
	-- Script settings, never go below 500 milliseconds. Increase for higher latency.
	click_wait_time = 1000			-- Wait time in milliseconds after each click.
	move_via_auto_approach = true	-- Set to true when you want to use auto approach for move to NPC.
	
	-- Script settings, do not touch
	learning = 1 					-- Initially the script needs to learn the htmls
	first_screen = 0				-- First screen html index
	timer = 0						-- Restrict clicking using this timer.
	crafting_step = 0				-- Crafting step
	enable_craft = 0				-- The script determines if the starting position is correct to start crafting
	abandon_workorder = 0;			-- Used to select work order in the journal to close failed work orders
	learned = 0;					-- Check if the screens have been learned
	enough_materials = 0			-- Material check
	
	-- Check which NPC with workorders is closest to you and do the work orders.
    NPC_name = CheckWorkorder()
	
	-- Non-configurable variables, do not touch any of these.
    start_location = Player:GetPosition();	-- Starting position to run to. This HAS to be in the crafting area!
	
end

--- OnRun is called each frame.
--
-- @return	void

function OnRun()
	-- Delay to skip YAY-crafted-an-item-animation
	if DialogList:GetDialog( "making_dialog" ):IsVisible() then
		timer = Time() + 4000 
		return
	end

	if Time() &gt; timer and not Player:IsMoving() then

		if InventoryList:GetSlotCurrent() == InventoryList:GetSlotMaximum() then
			Write("Your inventory is full, aborting script")
			Close()
		end
		
		-- Initial set-up of closing all screens
		if crafting_step == 0 then 
		
			if DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- close dialog screen
				stop_chat();
			elseif DialogList:GetDialog( "tool_making_dialog" ):IsVisible() then -- Crafting screen
				DialogList:GetDialog( "tool_making_dialog" ):SetVisible(false)
			else
				if learned == 0 then
					crafting_step = 1
				else
					crafting_step = 2
				end
			end
			
		-- Learn first screen dialog code
		elseif crafting_step == 1 then
		
			if not DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- no dialog, talk to npc
				start_chat()
			elseif first_screen == 0 then -- Learn the html code of the first screen
				first_screen = DialogList:GetDialog( "dlg_dialog/html_view" ):GetHTML()
				DialogList:GetDialog( "dlg_dialog/html_view/2" ):Click()
			elseif DialogList:GetDialog( "dlg_dialog/accept" ):IsVisible() then -- Accepting quest
				DialogList:GetDialog( "dlg_dialog/accept" ):Click()
				learned = 1
				crafting_step = 4
			elseif DialogList:GetDialog( "dlg_dialog/ok" ):IsVisible() then -- Already have the crafting quest accepted
				stop_chat();
				crafting_step = 3 -- stop the current work order
			else
				DialogList:GetDialog( "dlg_dialog/html_view/1" ):Click()
			end
			
		-- Aquiring the work order
		elseif crafting_step == 2 then 
		
			if not DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- no dialog, talk to npc (trying to make it idiot proof)
				start_chat()
			elseif DialogList:GetDialog( "dlg_dialog/html_view" ):GetHTML() == first_screen then -- First screen is open
				DialogList:GetDialog( "dlg_dialog/html_view/2" ):Click()
			elseif DialogList:GetDialog( "dlg_dialog/accept" ):IsVisible() then -- Accepting quest
				DialogList:GetDialog( "dlg_dialog/accept" ):Click()
				crafting_step = 4 -- go to starting position and close dialogs
			elseif DialogList:GetDialog( "dlg_dialog/ok" ):IsVisible() then -- Already have the crafting quest accepted
				stop_chat();
				crafting_step = 3 -- stop the current work order
			else -- second screen is open
				DialogList:GetDialog( "dlg_dialog/html_view/1" ):Click()
			end
			
		-- Stop the current work order (failed to craft everything)
		elseif crafting_step == 3 then
			
			if not DialogList:GetDialog( "quest_dialog" ):IsVisible() then -- Journal is not opened
				DialogList:GetDialog( "quest_dialog" ):SetVisible(true)
			else -- Journal is open
				if not DialogList:GetDialog( "quest_dialog/1/working_page/task_tab" ):IsVisible() then -- work order is not yet selected
					DialogList:GetDialog( "quest_dialog/quest_tabframe/quest_tab_task" ):Click()
				elseif not DialogList:GetDialog( "quest_dialog/giveup" ):IsEnabled() then -- work order tab is selected, work order is not selected
					local hDialog = DialogList:GetDialog( "quest_dialog/1/working_page/task_tab/working_list/0/1" )
					PlayerInput:Click( hDialog:GetPosition().X + ( 0.5 * hDialog:GetSize().X ), hDialog:GetPosition().Y + 5 )
				else
					local DidFindMatch = false;
					-- Iterate through the dialog to find a non-named confirmation dialog.
					for i = 0, DialogList:GetDialogSize() - 1 do
						-- Retrieve the dialog.
						local CurrentDialog = DialogList:GetDialogIndex( i, false );
						-- Check if the dialog matches expectations.
						if CurrentDialog ~= nil and CurrentDialog:GetName() == "" then
							-- Check if the dialog is visible and the OK button can be clicked.
							if CurrentDialog:IsVisible() and CurrentDialog:GetDialog( "ok" ) ~= nil then
								CurrentDialog:GetDialog( "ok" ):Click()
								DialogList:GetDialog( "quest_dialog" ):SetVisible(false)
								crafting_step = 2
								DidFindMatch = true;
							end
						-- Otherwise break from the iteration.
						else
							break;
						end
					end
					-- If a match was not found, the quest has to be abandoned.
					if not DidFindMatch then
						DialogList:GetDialog( "quest_dialog/giveup" ):Click()
					end
				end
			end

		-- Close dialogs and move to starting position
		elseif crafting_step == 4 then

			if DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- close dialog screen
				stop_chat();
			elseif DialogList:GetDialog( "tool_making_dialog" ):IsVisible() then -- Crafting screen
				DialogList:GetDialog( "tool_making_dialog" ):SetVisible(false)
			else 
				Player:SetMove( start_location )
				crafting_step = 5
			end
			
		-- Crafting
		elseif crafting_step == 5 then
			if DialogList:GetDialog( "tool_making_dialog" ):IsVisible() then -- craft screen is open
			
				if enable_craft == 0 then -- initially click the correct work order
					local hDialog = DialogList:GetDialog( "tool_making_dialog/making_scroll/making_ext0/making_list0" )
					PlayerInput:Click( hDialog:GetPosition().X + ( 0.5 * hDialog:GetSize().X ), hDialog:GetPosition().Y + 5 )
					enable_craft = 1
				else
				
					-- Check if you have enough materials on you
					if not DialogList:GetDialog( "tool_making_dialog/button_start_all" ):IsEnabled() and enough_materials == 0 then
						Write("Not enough materials/Incorrect starting position")
						Close()
						return
					else
						enough_materials = 1
					end
				
					if DialogList:GetDialog( "tool_making_dialog/button_start_all" ):IsEnabled() then
						DialogList:GetDialog( "tool_making_dialog/button_start_all" ):Click()
					else
						if enable_craft then -- reset script for next crafting iteration
							enable_craft = 0
							enough_materials = 0
							crafting_step = 6
							timer = Time() + 1000
						else
							Write( "Your starting location is not in a crafting area/nor you do not have the required items" )
							Close()
						end
					end
				end
			-- Craft screen has to be opened
			else
				if NPC_name == "Lainita" or NPC_name == "Hestia" then -- Cooking
					PlayerInput:Console("/skill Cooking")
				elseif NPC_name == "Honir" or NPC_name == "Diana" then -- Alchemy
					PlayerInput:Console("/skill Alchemy")
				elseif NPC_name == "Zyakia" or NPC_name == "Daphnis" then -- Tailoring
					PlayerInput:Console("/skill Tailoring")
				elseif NPC_name == "Kinterun" or NPC_name == "Vulcanus" then -- Armorsmithing
					PlayerInput:Console("/skill Armorsmithing")
				elseif NPC_name == "Logi" or NPC_name == "Anteros" then -- Weaponsmithing
					PlayerInput:Console("/skill Weaponsmithing")
				elseif NPC_name == "Lanse" or NPC_name == "Utsida" then -- Handicrafting
					PlayerInput:Console("/skill Handicrafting")
				end
			end
			
		-- Close crafting dialog
		elseif crafting_step == 6 then 
		
			if DialogList:GetDialog( "tool_making_dialog" ):IsVisible() then -- craft screen is open
				DialogList:GetDialog( "tool_making_dialog" ):SetVisible(false)
			else
				crafting_step = 7
			end
			
		-- hand in work order
		elseif crafting_step == 7 then
		
			if not DialogList:GetDialog( "dlg_dialog" ):IsVisible() then -- no dialog, talk to npc
				start_chat()
			elseif DialogList:GetDialog( "dlg_dialog/html_view" ):GetHTML() == first_screen then
				DialogList:GetDialog( "dlg_dialog/html_view/2" ):Click()
			elseif DialogList:GetDialog( "dlg_dialog/ok" ):IsVisible() then -- Hand in the work order
				DialogList:GetDialog( "dlg_dialog/ok" ):Click()
				crafting_step = 2 -- Blastradius: No need for Step #0, we can go to Step #2 and avoid dialog bugs.
			else -- second screen is open
				DialogList:GetDialog( "dlg_dialog/html_view/1" ):Click()
			end
			
		end
		
		timer = Time() + click_wait_time

	end
	
end

function start_chat()
	if Player:GetTargetID() == 0 then
--		PlayerInput:Escape()
		PlayerInput:Console( '/attack' )
		
	end

	local Entity = EntityList:GetEntity( NPC_name )
	if Player:GetTargetID() ~= Entity:GetID()  then -- Move to the target NPC
		Player:SetTarget( Entity )
		if not move_via_auto_approach then
			Player:SetMove( Entity:GetPosition())
		end
	else -- start dialog
		PlayerInput:Console( '/attack' )
	end

end	

function stop_chat()

	-- Get the information for the dialog.
	local DlgDialog = DialogList:GetDialog( "dlg_dialog" );
	local DlgPosition = DlgDialog:GetPosition();
	local DlgSize = DlgDialog:GetSize();
	
	-- Get the information for the cancel button. Avoid names, there are two similar named buttons.
	local CnlDialog = DialogList:GetDialog( "dlg_dialog/8" );
	local CnlSize = CnlDialog:GetSize();
	
	-- Calculate the real position on the X- and Y-axis.
	local Real_X = DlgPosition.X + DlgSize.X - ( DlgSize.X / 100 * 4 );
	local Real_Y = DlgPosition.Y + CnlSize.Y - ( CnlSize.Y / 100 * 4 );

	-- Click the button and continue.
	PlayerInput:Click( Real_X, Real_Y );
	
end

function CheckWorkorder()

	local NPCs = {"Lainita", "Honir", "Zyakia", "Kinterun", "Logi", "Lanse", "Diana", "Vulcanus", "Hestia", "Utsida", "Daphnis", "Anteros"}
	local Distance1 = 100
	local Distance2 = 100
	local NPC_name = ""
	
	for ID, Entity in DictionaryIterator( EntityList:GetList()) do
		for i = 1, #NPCs, 1 do
			if Entity:GetName() == NPCs[i] then
				Distance2 = Entity:GetPosition():DistanceToPosition( Player:GetPosition());
				if Distance2 &lt;= Distance1 then
				Write("Setting " .. NPCs[i] );
				Write(Distance2);
					NPC_name = NPCs[i]
					Distance1 = Distance2
				end
			end
		end
	end
	
	-- Visual verification
	if Distance1 == 100 then
		Write("No NPC nearby to do crafting")
		Close()
	else
		Write("NPC found with name " .. NPC_name)
		Write("with distance of " .. Distance1 .. " units")
		
		return NPC_name
	end

end
</code></pre></div></div>

			
									
						<div id='list_thanks1346'>
</div>
<div id='div_post_reput1346'>
</div>
			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1405" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile1405">
			<dt class="no-profile-rank has-avatar">
				
				<div class="avatar-container">
																<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="avatar"><img class="avatar" src="download/filee04a.png?avatar=571_1503261469.png" width="150" height="150" alt="User avatar" /></a>														</div>
								<a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search84ef.html?author_id=571&amp;sr=posts">65</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Aug 20, 2017 3:06 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="571"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/true.html">24 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="571"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/571/false.html">1 time</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1405">

						<h3 ><a href="#p1405">Re: Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="posting30e6.html?mode=quote&amp;f=6&amp;p=1405" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic4e45.html?p=1405#p1405" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist09a9.html?mode=viewprofile&amp;u=571" class="username">Quirunerk</a></strong> &raquo; </span>Fri Sep 01, 2017 11:13 am
			</p>
			
			
			
			<div class="content">I'm getting inventory is full aborting script error now :/</div>

			
									
						<div id='list_thanks1405'>
</div>
<div id='div_post_reput1405'>
</div>
			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1414" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile1414">
			<dt class="no-profile-rank has-avatar">
				
				<div class="avatar-container">
																<a href="memberlistbfa8.html?mode=viewprofile&amp;u=353" class="avatar"><img class="avatar" src="download/file189c.gif?avatar=353_1503005081.gif" width="150" height="150" alt="User avatar" /></a>														</div>
								<a href="memberlistbfa8.html?mode=viewprofile&amp;u=353" class="username">Diavolakos</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search4973.html?author_id=353&amp;sr=posts">114</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Apr 20, 2017 5:05 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="353"><strong>Has&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/353/true.html">31 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="353"><strong>Been&nbsp;thanked:</strong> <a href="app.php/thankslist/givens/353/false.html">13 times</a></dd>

						
		</dl>

		<div class="postbody">
						<div id="post_content1414">

						<h3 ><a href="#p1414">Re: Copy Paste.</a></h3>
													<ul class="post-buttons">
																																									<li>
							<a href="postingedc8.html?mode=quote&amp;f=6&amp;p=1414" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
															</ul>
							
						<p class="author">
									<a class="unread" href="viewtopice006.html?p=1414#p1414" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistbfa8.html?mode=viewprofile&amp;u=353" class="username">Diavolakos</a></strong> &raquo; </span>Sat Sep 02, 2017 9:53 am
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist09a9.html?mode=viewprofile&amp;u=571">Quirunerk</a> wrote: <a href="viewtopic4e45.html?p=1405#p1405" data-post-id="1405" onclick="if(document.getElementById(hash.substr(1)))href=hash">â†‘</a><div class="responsive-hide">Fri Sep 01, 2017 11:13 am</div></cite>
I'm getting inventory is full aborting script error now :/
</div></blockquote>

I also had this ESC problem so instead I kept it as it is and I lpace and /attack on the next thing it does and it works.<br>
<br>
The full inventory thing is an AS error, the ommand that sees the inventory is falwed and it gives wrong data.</div>

			
									
						<div id='list_thanks1414'>
</div>
<div id='div_post_reput1414'>
</div>
			<div id="sig1414" class="signature">I play on NA Server Siel</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting1b11-2.html?mode=reply&amp;f=6&amp;t=246" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
	
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic79d6.html?f=6&amp;t=246&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<form method="post" action="https://www.nyerk.xyz/viewtopic.php?f=6&amp;t=246">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			9 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforumcf19.html?f=6" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to â€œGeneral Discussionâ€</span>
		</a>
	</p>
	
		<br /><br />
	</div>

	<div class="stat-block online-list">
		<h3>Who is online</h3>
		<p>Users browsing this forum: No registered users and 0 guests</p>
	</div>

				
			</div>

	<div class="inventea-footer-wrapper">
		<div id="page-footer" class="inventea-footer" role="contentinfo">
			<nav role="navigation">
	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="index-2.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>

						<li class="small-icon" data-last-responsive="true"><a href="memberlist8733.html?mode=contactadmin" role="menuitem">Contact us</a></li>
				
		<li class="small-icon"><a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">Delete all board cookies</a></li>
				<li>All times are <span title="UTC">UTC</span></li>
			</ul>
</nav>

			<footer class="inventea-credits">
								Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited<br />
								Style we_universal created by <a href="https://inventea.com/" title="phpBB styles, HTML5 &amp; CSS3 templates">INVENTEA</a> & <a href="http://xeronix.org/" title="phpBB styles and much more">nextgen</a>
											</footer>
		</div>
	</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
	<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>
</div>

<script type="text/javascript" src="assets/javascript/jquery.min5d79.js?assets_version=25"></script>
<script type="text/javascript" src="assets/javascript/core5d79.js?assets_version=25"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fn5d79.js?assets_version=25"></script>
<script type="text/javascript" src="styles/prosilver/template/ajax5d79.js?assets_version=25"></script>



</body>

<!-- Mirrored from www.nyerk.xyz/viewtopic.php?p=1343 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 12 May 2018 09:46:19 GMT -->
</html>
